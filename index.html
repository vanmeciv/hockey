<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NHL Ice Surface + Event Logger</title>

<style>
  :root {
    --bg:#0b0f14;
    --panel:#111827;
    --text:#e5e7eb;
    --muted:#9ca3af;
    --btn:#1f2937;
    --btnActive:#374151;
    --border:#1f2937;
  }

  body {
    margin:0;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
    background:var(--bg);
    color:var(--text);
  }

  .app {
    min-height:100vh;
    display:flex;
    flex-direction:column;
  }

  header {
    padding:12px;
    border-bottom:1px solid var(--border);
    background:#0b0f14;
  }

  .scoreRow {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:8px;
  }

  .teams {
    display:flex;
    flex-direction:column;
    gap:2px;
  }

  .teamLine {
    display:flex;
    gap:8px;
    font-weight:700;
  }

  .clockRow {
    display:flex;
    justify-content:space-between;
    align-items:center;
  }

  .clock {
    font-size:28px;
    font-weight:800;
  }

  button {
    background:var(--btn);
    color:var(--text);
    border:0;
    border-radius:10px;
    padding:8px 12px;
    font-weight:700;
    cursor:pointer;
  }

  button:active { background:var(--btnActive); }

  main {
    flex:1;
    padding:12px 12px 160px;
  }

  /* ===== RINK ===== */
  #rink {
    width:100%;
    height:auto;
    border-radius:18px;
    background:#0b1220;
    border:1px solid var(--border);
    touch-action:manipulation;
  }

  #rinkHint {
    font-size:12px;
    color:var(--muted);
    margin-top:6px;
  }

  .events {
    margin-top:12px;
    display:flex;
    flex-direction:column;
    gap:8px;
  }

  .event {
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:12px;
    padding:8px 10px;
    font-size:14px;
  }

  /* ===== BUTTON GRID ===== */
  .stickyGrid {
    position:fixed;
    bottom:0;
    left:0;
    right:0;
    padding:12px;
    background:#0b0f14;
    border-top:1px solid var(--border);
  }

  .grid {
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
  }

  .toast {
    position:fixed;
    left:12px;
    right:12px;
    bottom:130px;
    padding:10px;
    background:#0b1220;
    border:1px solid var(--border);
    border-radius:12px;
    display:none;
    font-weight:700;
  }

  .toast.show { display:block; }
</style>
</head>

<body>
<div class="app">

<header>
  <div class="scoreRow">
    <div class="teams">
      <div class="teamLine">Home <span id="homeScore">0</span></div>
      <div class="teamLine">Away <span id="awayScore">0</span></div>
    </div>
    <button id="resetBtn">Reset</button>
  </div>

  <div class="clockRow">
    <div class="clock" id="clockLabel">20:00</div>
    <div>
      <button id="startStopBtn">Start</button>
      <button id="undoBtn">Undo</button>
    </div>
  </div>
</header>

<main>

<!-- ===== NHL REGULATION RINK (1 unit = 1 ft) ===== -->
<svg id="rink" viewBox="0 0 200 85" preserveAspectRatio="xMidYMid meet">
  <!-- Boards -->
  <rect x="0" y="0" width="200" height="85" rx="28" ry="28"
        fill="none" stroke="#e5e7eb" stroke-width="0.8"/>

  <!-- Goal lines -->
  <line x1="11" y1="0" x2="11" y2="85" stroke="#ef4444" stroke-width="0.17"/>
  <line x1="189" y1="0" x2="189" y2="85" stroke="#ef4444" stroke-width="0.17"/>

  <!-- Blue lines -->
  <rect x="74.5" y="0" width="1" height="85" fill="#3b82f6"/>
  <rect x="124.5" y="0" width="1" height="85" fill="#3b82f6"/>

  <!-- Center red line -->
  <rect x="99.5" y="0" width="1" height="85" fill="#ef4444"/>

  <!-- Center circle + dot -->
  <circle cx="100" cy="42.5" r="15" fill="none" stroke="#ef4444" stroke-width="0.6"/>
  <circle cx="100" cy="42.5" r="1" fill="#ef4444"/>

  <!-- End zone faceoff circles -->
  <circle cx="69" cy="22" r="15" fill="none" stroke="#ef4444" stroke-width="0.6"/>
  <circle cx="69" cy="63" r="15" fill="none" stroke="#ef4444" stroke-width="0.6"/>
  <circle cx="131" cy="22" r="15" fill="none" stroke="#ef4444" stroke-width="0.6"/>
  <circle cx="131" cy="63" r="15" fill="none" stroke="#ef4444" stroke-width="0.6"/>

  <!-- Faceoff dots -->
  <circle cx="69" cy="22" r="1" fill="#ef4444"/>
  <circle cx="69" cy="63" r="1" fill="#ef4444"/>
  <circle cx="131" cy="22" r="1" fill="#ef4444"/>
  <circle cx="131" cy="63" r="1" fill="#ef4444"/>

  <!-- Goal creases (D-shape) -->
  <path d="M 11 36.5 A 6 6 0 0 1 11 48.5 L 15 48.5 A 6 6 0 0 0 15 36.5 Z"
        fill="none" stroke="#60a5fa" stroke-width="0.6"/>
  <path d="M 189 36.5 A 6 6 0 0 0 189 48.5 L 185 48.5 A 6 6 0 0 1 185 36.5 Z"
        fill="none" stroke="#60a5fa" stroke-width="0.6"/>

  <!-- Goal dots -->
  <circle cx="20" cy="42.5" r="1" fill="#ef4444"/>
  <circle cx="180" cy="42.5" r="1" fill="#ef4444"/>

  <!-- Event markers -->
  <g id="markers"></g>
</svg>

<div id="rinkHint"></div>

<div class="events" id="eventsList"></div>

</main>

<div class="toast" id="toast">Event logged</div>

<div class="stickyGrid">
  <div class="grid">
    <button data-type="goal">GOAL</button>
    <button data-type="sog">SOG</button>
    <button data-type="hit">HIT</button>
    <button data-type="penalty">PENALTY</button>
    <button data-type="possession">POS</button>
    <button data-type="note">NOTE</button>
  </div>
</div>

</div>

<script>
const state = {
  clock: 20*60,
  running:false,
  events:[],
  pending:null,
  home:0,
  away:0
};

const rink = document.getElementById("rink");
const markers = document.getElementById("markers");
const eventsList = document.getElementById("eventsList");
const toast = document.getElementById("toast");

function format(t){ return String(Math.floor(t/60)).padStart(2,"0")+":"+String(t%60).padStart(2,"0"); }

function render(){
  document.getElementById("clockLabel").textContent = format(state.clock);
  document.getElementById("homeScore").textContent = state.home;
  document.getElementById("awayScore").textContent = state.away;

  eventsList.innerHTML = state.events.map(e=>`<div class="event">${e.type.toUpperCase()} @ ${format(e.time)}</div>`).join("");

  markers.innerHTML="";
  for(const e of state.events){
    if(!e.xy) continue;
    const c=document.createElementNS("http://www.w3.org/2000/svg","circle");
    c.setAttribute("cx",e.xy.x);
    c.setAttribute("cy",e.xy.y);
    c.setAttribute("r",2);
    c.setAttribute("stroke","#e5e7eb");
    c.setAttribute("fill","none");
    c.setAttribute("stroke-width","1");
    markers.appendChild(c);
  }
}

function log(type){
  const e={type,time:state.clock};
  state.events.unshift(e);
  state.pending=e;
  toast.textContent=type.toUpperCase()+" logged â€” tap rink";
  toast.classList.add("show");
  setTimeout(()=>toast.classList.remove("show"),2000);
  render();
}

document.querySelectorAll(".grid button").forEach(b=>{
  b.onclick=()=>log(b.dataset.type);
});

rink.addEventListener("click",e=>{
  if(!state.pending) return;
  const r=rink.getBoundingClientRect();
  state.pending.xy={
    x:(e.clientX-r.left)/r.width*200,
    y:(e.clientY-r.top)/r.height*85
  };
  state.pending=null;
  render();
});

document.getElementById("startStopBtn").onclick=()=>{
  state.running=!state.running;
};

document.getElementById("undoBtn").onclick=()=>{
  state.events.shift();
  render();
};

setInterval(()=>{
  if(state.running && state.clock>0){
    state.clock--;
    render();
  }
},1000);

render();
</script>
</body>
</html>
